<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Charging Policies & Mechanisms</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <!-- Shared stylesheet -->
    <link rel="stylesheet" href="style.css" />

    <!-- MathJax -->
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async
        src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        .policy-section, .mech-section {
            margin-bottom: 40px;
        }

        .card p, li {
            line-height: 1.55;
            color: var(--subtext);
        }
    </style>
</head>

<body>

    <!-- Charging bar -->
    <div id="charging-bar">
        <div id="charging-fill"></div>
    </div>

    <!-- Header -->
    <header>
    <nav>
        <div class="title">
            <div class="batt-nav"><div class="batt-fill"></div></div>
            <span>BatterySim ODE Project</span>
        </div>
        <ul>
            <li><a style="color: var(--accent)">Home</a></li>
            <li><a href="policies.html">Policies &amp; Mechanisms</a></li>
            <li><a href="equations.html">Equations</a></li>
            <li><a href="simulate.html">Simulation</a></li>
            <li><a href="code.html">Code</a></li>
        </ul>
    </nav>
</header>


    <section class="policy-section">
        <h2>Charging Policies</h2>
        <p>
            Charging policies describe how the **source voltage** is computed at each timestep.
            Each policy class implements:
        </p>
        <p>
            <code>get_voltage(t, y)</code>  
            where \( y = [V, I, R, T, \text{SOC}, \text{SEI}, V_{transient}] \)
        </p>

        <!-- Constant Voltage -->
        <div class="card">
            <h3>1. Constant Voltage (CV)</h3>
            <p>Applies a fixed voltage during the charge cycle.</p>
            <p>
                \[
                    V_{\text{source}}(t) = V_{set}
                \]
            </p>
            <p>
                In code:
                <pre>return self.voltage</pre>
            </p>
        </div>

        <!-- Constant Current -->
        <div class="card">
            <h3>2. Constant Current (CC)</h3>
            <p>Adjusts the source voltage to maintain a desired current.</p>
            <p>
                \[
                    V_{\text{source}}(t) = I_{set} \cdot R(t) + \text{OCV}(\text{SOC}(t))
                \]
            </p>
            <p>Matches real-world CC charging through voltage regulation.</p>
        </div>

        <!-- Pulse charging -->
        <div class="card">
            <h3>3. Pulse Charging</h3>
            <p>
                Alternates between charging at a fixed current and resting.
            </p>
            <p>
                \[
                    V_{\text{source}}(t) =
                    \begin{cases}
                        I_{set} \cdot R(t) + \text{OCV}, & (t \bmod (t_{on}+t_{off})) < t_{on} \\
                        \text{OCV}, & \text{otherwise}
                    \end{cases}
                \]
            </p>
        </div>

        <!-- Sinusoidal -->
        <div class="card">
            <h3>4. Sinusoidal Charging</h3>
            <p>Uses a sinusoidally varying current magnitude.</p>
            <p>
                \[
                    V_{\text{source}}(t) =
                    | I_{set} \sin(2\pi f t) | \cdot R(t) + \text{OCV}
                \]
            </p>
        </div>
    </section>

    <!-- Mechanisms -->
    <section class="mech-section">
        <h2>Battery Mechanisms</h2>
        <p>
            These physical mechanisms produce the ODEs governing voltage, temperature, SOC, SEI, and transient behavior.
        </p>

        <!-- CHARGING MECHANISM -->
        <div class="card">
            <h3>1. Charging Mechanism (SOC Update)</h3>
            <p>
                The SOC evolves via:
                \[
                    \frac{d\,\text{SOC}}{dt} = \frac{I(t)}{C_{\text{nominal}} \cdot 3600}
                \]
            </p>
        </div>

        <!-- THERMO -->
        <div class="card">
            <h3>2. Thermal Mechanism</h3>
            <p>Sums ohmic heating and cooling to ambient temperature.</p>
            <p>
                Ohmic heating:
                \[
                    \frac{dT}{dt} = \frac{I^2 R}{m c}
                \]
            </p>
            <p>
                Cooling:
                \[
                    \frac{dT}{dt} = -k(T - T_{amb})
                \]
            </p>
        </div>

        <!-- SEI Simplified -->
        <div class="card">
            <h3>3. SEI (Simplified Model)</h3>
            <p>
                Growth rate governed by Arrhenius temperature scaling and
                SOC/current stress.
            </p>
            <p>
                \[
                    k_T = k_0 e^{-E_a / (RT)}
                \]
            </p>
            <p>
                Stress term:
                \[
                    f_{QI} = (1+2\,\text{SOC}^2)(1 + 0.1|I|)
                \]
            </p>
            <p>
                Combined:
                \[
                    \frac{d(\text{SEI})}{dt} = k_T f_{QI}
                \]
            </p>
        </div>

        <!-- SEI Full Model -->
        <div class="card">
            <h3>4. SEI (Full Model)</h3>
            <p>
                Includes dependence on anode potential, current nonlinearity,
                and exponential SOC scaling.
            </p>
            <p>
                \[
                    f_{QI} = 
                    A \exp\left(\gamma_{\text{soc}}(U_{ref} - U_{ocv})\right)
                    \left(1 + \beta_I |I| \right)^\nu
                \]
            </p>
            <p>
                \[
                    \frac{d(\text{SEI})}{dt}
                    = k_0 e^{-E_a/(RT)} \;\; f_{QI}
                \]
            </p>
        </div>

        <!-- TRANSIENT -->
        <div class="card">
            <h3>5. Transient RC Mechanism</h3>
            <p>
                Models overpotential dynamics using an RC circuit:
                \[
                    \frac{dV_c}{dt} = -\frac{1}{RC} V_c + \frac{1}{C} I
                \]
            </p>
        </div>
    </section>

    <footer>
        Â© 2025 BatterySim ODE Project
    </footer>

    <!-- Scroll animations -->
    <script>
        document.addEventListener("scroll", () => {
            const scrollY = window.scrollY;
            const docHeight = document.body.scrollHeight - window.innerHeight;
            const progress = docHeight > 0 ? (scrollY / docHeight) * 100 : 0;

            const fill = document.getElementById("charging-fill");
            if (fill) fill.style.height = progress + "%";

            document.querySelectorAll("section").forEach(sec => {
                const rect = sec.getBoundingClientRect();
                if (rect.top < window.innerHeight - 80) {
                    sec.classList.add("visible");
                }
            });
        });

        window.addEventListener("load", () => {
            document.dispatchEvent(new Event("scroll"));
        });
    </script>
</body>
</html>
